{{ define "main" }}

<!-- blog -->
<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto px-0">
        <h2 class="block">Posts related to <span class="text-primary">{{ .Title }}</span></h2>
        <div class="bg-white shadow block">

          {{/* Separate pinned and normal posts */}}
          {{ $pinned := where .Data.Pages "Params.pinned" true }}
          {{ $others := where .Data.Pages "Params.pinned" "!=" true }}

          {{/* Display pinned posts first (no pagination) */}}
          {{ range $pinned.ByPublishDate.Reverse }}
            {{ .Render "article" }}
          {{ end }}

          {{/* Then paginate the rest */}}
          {{ $paginator := .Paginate ($others.ByPublishDate.Reverse) }}
          {{ range $paginator.Pages }}
            {{ .Render "article" }}
          {{ end }}

          <!-- pagination -->
          <div class="mt-5">
            {{ template "_internal/pagination.html" . }}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- /blog -->

{{ end }}
